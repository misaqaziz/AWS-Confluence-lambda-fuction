<div id="bucket-table-container" style="font-family: Arial, sans-serif; max-width: 600px; margin: 10px 0;">
  <h3 style="margin-bottom: 10px;">List of Buckets</h3>
  <button id="refresh-buckets" style="margin-bottom: 10px; padding: 5px 10px; cursor: pointer;">Refresh</button>
  <table border="1" style="border-collapse: collapse; width: 100%; text-align: left;">
    <thead style="background-color: #f2f2f2;">
      <tr>
        <th style="padding: 8px;">Bucket Name</th>
        <th style="padding: 8px;">Owner</th>
      </tr>
    </thead>
    <tbody id="bucket-table-body">
      <tr>
        <td colspan="2" style="padding: 8px;">Loading...</td>
      </tr>
    </tbody>
  </table>
  <p id="bucket-error" style="color: red; display: none; margin-top: 5px;"></p>
</div>

<script>
async function fetchBuckets() {
    const apiUrl = 'https://w096b5oymb.execute-api.ap-northeast-1.amazonaws.com/default/misaq';
    const tableBody = document.getElementById('bucket-table-body');
    const errorMsg = document.getElementById('bucket-error');

    tableBody.innerHTML = '<tr><td colspan="2" style="padding: 8px;">Loading...</td></tr>';
    errorMsg.style.display = 'none';

    try {
        const response = await fetch(apiUrl);
        if (!response.ok) throw new Error('HTTP error ' + response.status);
        const result = await response.json();

        // Use the 'buckets' array from API response
        const data = result.buckets || [];

        if (data.length === 0) {
            tableBody.innerHTML = '<tr><td colspan="2" style="padding: 8px;">No buckets found</td></tr>';
            return;
        }

        tableBody.innerHTML = '';
        data.forEach(bucket => {
            const row = document.createElement('tr');
            const nameCell = document.createElement('td');
            nameCell.textContent = bucket.Name || '';
            nameCell.style.padding = '8px';
            const ownerCell = document.createElement('td');
            ownerCell.textContent = bucket.Owner || '';
            ownerCell.style.padding = '8px';
            row.appendChild(nameCell);
            row.appendChild(ownerCell);
            tableBody.appendChild(row);
        });
    } catch (error) {
        console.error('Error fetching buckets:', error);
        tableBody.innerHTML = '<tr><td colspan="2" style="padding: 8px;">Error loading data</td></tr>';
        errorMsg.textContent = 'Error: ' + error.message;
        errorMsg.style.display = 'block';
    }
}

// Initial load
fetchBuckets();

// Refresh button
document.getElementById('refresh-buckets').addEventListener('click', fetchBuckets);
</script>
